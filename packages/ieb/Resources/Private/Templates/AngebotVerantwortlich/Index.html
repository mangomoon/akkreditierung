<html
        xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers"
        xmlns:ieb="http://typo3.org/ns/GeorgRinger/Ieb/ViewHelpers"
        data-namespace-typo3-fluid="true">
<f:layout name="Default" />
<f:section name="content">
    
    <div class="formzeile">
        <f:link.action action="new" class="formlink angebotssteuernde">Neue Person anlegen</f:link.action>
    </div>

    <f:if condition="{angebotVerantwortliches}">


        <table class="tx_ieb angebotVerantwortlich">
            <tr style="background: none;">
                <th class="nachname">
                    &nbsp;
                    </td>
                    <th class="vorname">
                        &nbsp;
                    </th>
                    <th>letzte Änderung</th>
                    <th></th>
                    <th class="td-knopf">

                    </th>
                    <th class="td-knopf">

                    </th>
            </tr>
            <f:for each="{angebotVerantwortliches}" as="angebotVerantwortlich">

                <f:variable name="relationUsagesInReview">{ieb:relationUsedInReview(object: angebotVerantwortlich)}</f:variable>
                <f:variable name="relationUsages">{ieb:relationUsed(object: angebotVerantwortlich)}</f:variable>
                <f:if condition="!{angebotVerantwortlich.archiviert}">
                    <f:then>
                        <tr class="{f:if(condition:angebotVerantwortlich.ok,then:'istok',else:'unok')}">
                            <td class="nachname">
                                {angebotVerantwortlich.nachname}
                            </td>
                            <td class="vorname">
                                {angebotVerantwortlich.vorname}
                            </td>
                            <td>{angebotVerantwortlich.tstamp -> f:format.date(format:'d.m.Y')}</td>
                            <td class="">
                                <f:if condition="{angebotVerantwortlich.ok}">
                                    <f:then>
                                        <span class="titleview knopfrund ok-grey" title="Angaben sind vollständig"></span>
                                    </f:then>
                                    <f:else>
                                        
                                    </f:else>
                                </f:if>
                                <f:if condition="{angebotVerantwortlich.reviewC1Babi}">
                                    
                                </f:if>
                                <f:if condition="{angebotVerantwortlich.reviewC1Psa}">
                                    
                                </f:if>
                            </td>
                            <td class="td-knopf">
                                <f:link.action action="show" title="Datensatz anzeigen" class="knopf-quadratisch show" arguments="{angebotVerantwortlich : angebotVerantwortlich}">
                                </f:link.action>
                            </td>
                            <td class="td-knopf">
                                <f:if condition="{relationUsages}">
                                <f:then>
                                    <div class="locked-grey knopf-quadratisch" title="Wird verwendet in Ansuchen: <br><f:for each='{relationUsages}' as='relationUsage'>
                                        {relationUsage.nummer} ({relationUsage.name})<br>
                                    </f:for> und kann daher nicht archiviert werden"></div>
                                </f:then>
                                <f:else>
                                    <f:link.action action="archive" title="Datensatz archivieren" class="knopf-quadratisch hide" arguments="{berater : berater}">
                            </f:link.action>
                                </f:else>
                            </f:if>
                            </td>
                            <td class="td-knopf">
                                <f:if condition="{relationUsagesInreview}">
                                    <f:then>
                                        <div class="locked knopf-quadratisch" title="In Begutachtung, Ansuchen: <br><f:for each='{relationUsagesInReview}' as='relationUsage'>
                                            {relationUsage.nummer} ({relationUsage.name})<br>
                                        </f:for>"></div>
                                    </f:then>
                                    <f:else>
                                        <f:link.action action="edit" title="Datensatz bearbeiten" class="knopf-quadratisch edit" arguments="{angebotVerantwortlich : angebotVerantwortlich}">
                                        </f:link.action>
                                    </f:else>
                                </f:if>
                            </td>
                        </tr>
                    </f:then>
                    <f:else>
                        {f:variable(name: 'archiviertexistiert', value: 'ja')}
                    </f:else>
                </f:if>
            </f:for>
        </table>

        <div class="abstand-mittel"></div>
        <f:if condition="{archiviertexistiert}=='ja'">
            <div class="archiv">
                <h2>ARCHIV</h2>
                <table class="tx_ieb angebotVerantwortlich">
                    <f:for each="{angebotVerantwortliches}" as="angebotVerantwortlich">
                        <f:if condition="{angebotVerantwortlich.archiviert}">
                            <tr>
                                <td class="nachname">
                                    {angebotVerantwortlich.nachname}
                                </td>
                                <td class="vorname">
                                    {angebotVerantwortlich.vorname}
                                </td>
                                <td>{angebotVerantwortlich.tstamp -> f:format.date(format:'d.m.Y')}</td>
                                <td class="">
                                    <f:if condition="{angebotVerantwortlich.ok}">
                                        <f:then>
                                            ja
                                        </f:then>
                                        <f:else>
                                            nein
                                        </f:else>
                                    </f:if>

                                </td>
                                <td class="td-knopf">
                                    <f:link.action action="show" title="Datensatz anzeigen" class="knopf-quadratisch show" arguments="{angebotVerantwortlich : angebotVerantwortlich}">
                                    </f:link.action>
                                </td>
                                <td class="td-knopf">
                                    <f:link.action action="revive" title="Datensatz wieder hinzufügen" class="knopf-quadratisch revive" arguments="{angebotVerantwortlich : angebotVerantwortlich}">
                                    </f:link.action>
                                </td>
                                <td class="td-knopf">

                                </td>
                            </tr>
                        </f:if>
                    </f:for>
                </table>
            </div>
        </f:if>
    </f:if>

    <div class="formzeile">
        <f:link.action action="new" class="formlink angebotssteuernde">Neue Person anlegen</f:link.action>
    </div>
</f:section>

</html>