<html
        xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers"
        xmlns:ieb="http://typo3.org/ns/GeorgRinger/Ieb/ViewHelpers"
        data-namespace-typo3-fluid="true">
<f:layout name="Default" />

<f:section name="content">

    <f:if condition="{beraters -> f:count()} > 1">
        <div class="kriterium">
            <f:form action="index" id="suche" object="{beraterSearch}" name="beraterSearch">
                <div class="row">
                    <div class="col-5">
                        <label for="vorname">Vorname</label>
                        <f:form.textfield property="vorname" id="vorname" class="breite100" />
                    </div>
                    <div class="col-5">
                        <label for="nachname">Nachname</label>
                        <f:form.textfield property="nachname" id="nachname" class="breite100" />
                    </div>
                    <div class="col-2">
                        <f:form.submit value="Suche" class="knopf-s2 suche" />
                    </div>
                </div>
                <f:if condition="{beraterSearch.used}">
                    <div class="row">
                        <div class="col">
                            <p><span class="label">Gesucht wurde nach:</span> <span class="suchwort">»{beraterSearch.vorname} {beraterSearch.nachname}«</span></p>
                            <p>
                                <f:link.page class="knopf-s2 suchezurueck">Suche zurücksetzen</f:link.page>
                            </p>
                            <p>&nbsp;</p>
                        </div>
                    </div>
                </f:if>
            </f:form>
        </div>
    </f:if>

    <div class="formzeile">
        <f:link.action action="new" class="formlink berater">Neue Person anlegen</f:link.action>
    </div>

    <f:if condition="{beraters}">
        <table class="tx_ieb berater">
            <tr style="background: none;">
                <th class="nachname">
                    &nbsp;
                    </td>
                    <th class="vorname">
                        &nbsp;
                    </th>
                    <th>letzte Änderung</th>
                    <th>vollständig</th>
                    <th class="td-knopf">

                    </th>
                    <th class="td-knopf">

                    </th>
            </tr>
            <f:for each="{beraters}" as="berater">
                <f:variable name="relationUsages">{ieb:relationUsed(object: berater)}</f:variable>
                <f:if condition="!{berater.archiviert}">
                    <f:then>


                        <tr class="{f:if(condition:berater.ok,then:'istok',else:'unok')}">
                            <td class="nachname">
                                {berater.nachname}
                            </td>
                            <td class="vorname">
                                {berater.vorname}
                            </td>
                            <td>{berater.tstamp -> f:format.date(format:'d.m.Y')}</td>
                            <td class="">
                                <f:if condition="{berater.ok}">
                                    <f:then>
                                        ja
                                    </f:then>
                                    <f:else>
                                        nein
                                    </f:else>
                                </f:if>

                            </td>
                            <td class="td-knopf">
                                <f:link.action action="show" title="Datensatz anzeigen" class="knopf-quadratisch show" arguments="{berater : berater}">
                                </f:link.action>
                            </td>
                            <td class="td-knopf">
                                <f:link.action action="archive" title="Datensatz archivieren" class="knopf-quadratisch hide" arguments="{berater : berater}">
                                </f:link.action>
                            </td>
                            <td class="td-knopf">
                                <f:if condition="{relationUsages}">
                                    <f:then>
                                        <div class="locked knopf-quadratisch"></div>
                                        <div style="display: none">
                                            <f:for each="{relationUsages}" as="relationUsage">
                                                {relationUsage.name},
                                            </f:for>
                                        </div>
                                    </f:then>
                                    <f:else>
                                        <f:link.action action="edit" title="Datensatz bearbeiten" class="knopf-quadratisch edit" arguments="{berater : berater}">
                                        </f:link.action>
                                    </f:else>
                                </f:if>
                            </td>
                        </tr>
                    </f:then>
                    <f:else>
                        {f:variable(name: 'archiviertexistiert', value: 'ja')}
                    </f:else>
                </f:if>
            </f:for>
        </table>
    </f:if>
    <f:if condition="{archiviertexistiert}=='ja'">
        <div class="abstand-mittel"></div>
        <div class="archiv">
            <h2>ARCHIV</h2>
            <table class="tx_ieb standortliste">
                <f:for each="{beraters}" as="berater">
                    <f:variable name="relationUsages">{ieb:relationUsed(object: trainer)}</f:variable>
                    <f:if condition="{berater.archiviert}">
                        <tr class="{f:if(condition:berater.ok,then:'istok',else:'unok')}">
                            <td class="nachname">
                                {berater.nachname}
                            </td>
                            <td class="vorname">
                                {berater.vorname}
                            </td>
                            <td>{berater.tstamp -> f:format.date(format:'d.m.Y')}</td>
                            <td class="">
                                <f:if condition="{berater.ok}">
                                    <f:then>
                                        ja
                                    </f:then>
                                    <f:else>
                                        nein
                                    </f:else>
                                </f:if>

                            </td>
                            <td class="td-knopf">
                                <f:link.action action="show" title="Datensatz anzeigen" class="knopf-quadratisch show" arguments="{berater : berater}">
                                </f:link.action>
                            </td>
                            <td class="td-knopf">
                                <f:link.action action="revive" title="Datensatz wiederherstellen" class="knopf-quadratisch revive" arguments="{berater : berater}">
                                </f:link.action>
                            </td>
                            <td class="td-knopf">

                            </td>
                        </tr>
                    </f:if>
                </f:for>
            </table>
        </div>
    </f:if>


    <div class="formzeile">
        <f:link.action action="new" class="formlink berater">Neue Person anlegen</f:link.action>
    </div>

</f:section>

</html>