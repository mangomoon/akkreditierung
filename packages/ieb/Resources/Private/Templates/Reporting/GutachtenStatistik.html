<html
        xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers"
        xmlns:ieb="http://typo3.org/ns/GeorgRinger/Ieb/ViewHelpers"
        data-namespace-typo3-fluid="true">
<f:layout name="Default"/>

<f:section name="content">
    <h2>Zuteilungsstatistik Gutachter:innen</h2>
    <label>Zeitraum (Quartal):</label>

    <f:form action="gutachtenStatistik" name="gutachtenStatistik" id="gutachtenStatistikform" method="post">
        

    <!-- <input type="hidden" id="csvinput" name="tx_ieb_reporting[csv]" value="1" /> -->
    <f:form.select name="selected" value="{selected}" options="{dateRanges}" prependOptionLabel="" prependOptionValue="" />
        <!-- &nbsp;&nbsp;&nbsp;<f:form.submit class="knopf-s2" value="anzeigen"/> 

    <f:form.submit class="knopf-s2" value="als CSV HERUNTERLADEN"/> -->

        <div class="abstand-mittel"></div>
        <div class="knopf-s knopfersatz" id="anzeigen-knopf" >anzeigen</div> <div class="knopf-s knopfersatz" id="csv-knopf">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CSV&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
        <div class="abstand-gross"></div>
    </f:form>
    <f:if condition="{items}">
        <f:then>
            <table class="auswertung gs-liste">
                <thead>
                <tr>
                    <th>DATUM</th>
                    <th>NAME</th>
                    <th>1/2</th>
                    <th>NR</th>
                    <th>V</th>
                    <th>ORGANISATION</th>
                    <th>€</th>
                    <th>KOMMENTAR</th>
                    <th>STATUS BEI ZUTEILUNG</th>
                </tr>
                </thead>
                <tbody>
                <f:for each="{items}" as="item" iteration="i">
                    <f:if condition="{altezuteilung} != {item.zuteilung_datum}">
                    <f:if condition="{item.zuteilung_datum} && {item.gutachter1}">
                        <tr>
                            <td class="datum"><f:format.date format='d.m.Y'>{item.zuteilung_datum}</f:format.date></td>
                            <td class="gutachter">{f:if(condition:item.gutachter1,then:'{item.gutachter1.first_name}&nbsp;{item.gutachter1.last_name}')}</td>
                            <td>1</td>
                            <td class="nummer">{item.nummer}</td>
                            <td class="nummer">{item.version}</td>
                            <td>{item.copy_stammdaten.name}</td>
                            <td class="datum">
                                {f:if(condition: '{item.review_verrechnung_check1}', then: 'ja', else: 'nein')}
                            </td>
                            <td class="aktion">
                                <f:if condition="{item.review_verrechnung1}"><f:then>{item.review_verrechnung1}</f:then><f:else></f:else></f:if>
                            </td>
                            
                            <td class="aktion"><code>Incoming Status: {item.review_incoming_status} | Status: {item.status}</code>
                                <f:switch expression="{item.review_incoming_status}">
                                    <f:case value="30">Ersteinreichung</f:case>
                                    <f:case value="85">Nachbesserungsauftrag</f:case>
                                    <f:case value="150">Nachakreditierung</f:case>
                                    <f:case value="160">Nachakreditierung</f:case>
                                    <f:case value="210">Nachakreditierung (Bearbeitungsauftrag)</f:case>
                                    <f:case value="230">Nachakreditierung (Bearbeitungsauftrag)</f:case>
                                </f:switch>
                            </td>
                        </tr>
                    </f:if>
                    <f:if condition="{item.zuteilung_datum} && {item.gutachter2}">
                        <tr>
                            <td class="datum"><f:format.date format='d.m.Y'>{item.zuteilung_datum}</f:format.date></td>
                            <td class="gutachter">{f:if(condition:item.gutachter2,then:'{item.gutachter2.first_name}&nbsp;{item.gutachter2.last_name}')}</td>
                            <td>2</td>
                            <td class="nummer">{item.nummer}</td>
                            <td class="nummer">{item.version}</td>
                            <td>{item.copy_stammdaten.name}</td>
                            <td class="datum">
                                {f:if(condition: '{item.review_verrechnung_check2}', then: 'ja', else: 'nein')}
                            </td>
                            <td class="aktion">
                                <f:if condition="{item.review_verrechnung1}"><f:then>{item.review_verrechnung2}</f:then><f:else></f:else></f:if>
                            </td>
                            <td class="aktion"><code>Incoming Status: {item.review_incoming_status} | Status: {item.status}</code>
                                <f:switch expression="{item.review_incoming_status}">
                                    <f:case value="30">Ersteinreichung</f:case>
                                    <f:case value="85">Nachbesserungsauftrag</f:case>
                                    <f:case value="150">Nachakreditierung</f:case>
                                    <f:case value="160">Nachakreditierung</f:case>
                                    <f:case value="210">Nachakreditierung (Bearbeitungsauftrag)</f:case>
                                    <f:case value="230">Nachakreditierung (Bearbeitungsauftrag)</f:case>
                                </f:switch>
                            </td>
                        </tr>
                    </f:if>

                    <f:variable name="altezuteilung">{item.zuteilung_datum}</f:variable>
                </f:if>
                </f:for>
                </tbody>
            </table>
        </f:then>
        <f:else>
            <p>Keine Daten für diesen Zeitraum.</p>
        </f:else>
    </f:if>
</f:section>

</html>